
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Neighbor lists &#8212; libcasm-clexulator 2.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=1d1c7082" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/neighbor_lists';</script>
    <link rel="icon" href="../_static/favicon-16x16.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="libcasm package" href="../reference/libcasm/index.html" />
    <link rel="prev" title="Evaluating order parameters" href="order_parameters.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/small_logo.svg" class="logo__image only-light" alt=""/>
    <img src="../_static/small_logo_dark.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">libcasm-clexulator</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/libcasm/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../bibliography.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/prisms-center/CASMcode_clexulator/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/libcasm-clexulator/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/libcasm/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../bibliography.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/prisms-center/CASMcode_clexulator/" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/libcasm-clexulator/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="config_dof_values.html">The ConfigDoFValues data structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_expansion.html">Evaluating a cluster expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_cluster_expansion.html">Evaluating a local cluster expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_expansion_details.html">Cluster expansion details</a></li>
<li class="toctree-l1"><a class="reference internal" href="order_parameters.html">Evaluating order parameters</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Neighbor lists</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../usage.html" class="nav-link">Usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Neighbor lists</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="neighbor-lists">
<span id="neighbor-lists-index"></span><h1>Neighbor lists<a class="headerlink" href="#neighbor-lists" title="Link to this heading">#</a></h1>
<p><a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.Clexulator.html#libcasm.clexulator.Clexulator" title="libcasm.clexulator.Clexulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Clexulator</span></code></a> source code contains the definition for a single translational equivalent of each cluster basis function. A neighbor list is used to determine the correct degree of freedom (DoF) values to evaluate the cluster basis function at a particular lattice translation. There are two types of neighbor lists:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a>: A prim neighbor list, defines an ordering of unit cells in the local neighborhood of a reference unit cell for a particular <a class="reference external" href="https://prisms-center.github.io/CASMcode_pydocs/libcasm/xtal/2.0/reference/libcasm/_autosummary/libcasm.xtal.Prim.html#libcasm.xtal.Prim" title="(in libcasm-xtal v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prim</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a>: A supercell neighbor list, uses the ordering specified by a prim neighbor list to construct a neighbor list for each unit cell in a supercell. One of these must be generated for each supercell in which cluster basis functions are evaluated.</p></li>
</ul>
<p>In the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a>, unit cells are ordered by lexicographically sorting the vectors <span class="math notranslate nohighlight">\([r, i, j, k]\)</span>, where <span class="math notranslate nohighlight">\(i,j,k\)</span> are the integer unit cell coordinates which specify the unit cell origin as multiples of the prim lattice vectors, and <span class="math notranslate nohighlight">\(r\)</span> is the integer distance <span class="math notranslate nohighlight">\(x^{\mathsf{T}} W x\)</span>, where <span class="math notranslate nohighlight">\(x=[i, j, k]\)</span>, and <span class="math notranslate nohighlight">\(W\)</span> is an integer lattice weight matrix which is typically chosen based on the lattice vectors to make an approximately spherical neighborhood in Cartesian coordinates. Whenever a new unit cell is inserted in the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a>, a bounding box based on <span class="math notranslate nohighlight">\(W\)</span> is used to ensure that all other unit cells with <span class="math notranslate nohighlight">\(r\)</span> of equal or lesser value are also inserted.</p>
<p>In the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a>, sites are ordered by lexicographically sorting the vectors <span class="math notranslate nohighlight">\([r, i, j, k, b]\)</span>, where <span class="math notranslate nohighlight">\(r, i, j, k\)</span> are defined as before, and <cite>b</cite> is the sublattice index of the site. Only sites with sublattice indices specified by the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a> constructor parameter <cite>sublattice_indices</cite> are included in the neighbor list. By default, any <a class="reference external" href="https://prisms-center.github.io/CASMcode_pydocs/libcasm/xtal/2.0/reference/libcasm/_autosummary/libcasm.xtal.Prim.html#libcasm.xtal.Prim" title="(in libcasm-xtal v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prim</span></code></a> sublattice that has 2 or more allowed occupants or 1 or more allowed continuous degree of freedom (DoF) is included.</p>
<section id="constructing-neighbor-lists">
<h2>Constructing neighbor lists<a class="headerlink" href="#constructing-neighbor-lists" title="Link to this heading">#</a></h2>
<p>In most cases, CASM chooses an appropriate set of default parameters for the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a> automatically from the <a class="reference external" href="https://prisms-center.github.io/CASMcode_pydocs/libcasm/xtal/2.0/reference/libcasm/_autosummary/libcasm.xtal.Prim.html#libcasm.xtal.Prim" title="(in libcasm-xtal v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prim</span></code></a> using the factory function <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.make_default_prim_neighbor_list.html#libcasm.clexulator.make_default_prim_neighbor_list" title="libcasm.clexulator.make_default_prim_neighbor_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_default_prim_neighbor_list()</span></code></a> as in the following example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">libcasm.xtal</span> <span class="k">as</span> <span class="nn">xtal</span>
<span class="kn">import</span> <span class="nn">libcasm.xtal.prims</span> <span class="k">as</span> <span class="nn">xtal_prims</span>
<span class="kn">from</span> <span class="nn">libcasm.clexulator</span> <span class="kn">import</span> <span class="n">make_default_prim_neighbor_list</span>

<span class="n">xtal_prim</span> <span class="o">=</span> <span class="n">xtal_prims</span><span class="o">.</span><span class="n">HCP</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">occ_dof</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>
<span class="n">prim_neighbor_list</span> <span class="o">=</span> <span class="n">make_default_prim_neighbor_list</span><span class="p">(</span><span class="n">xtal_prim</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a> can then be expanded to ensure that unit cells or sites from all relevant clusters relative to the origin unit cell are included. The order in which sites or unit cells are added to the neighbor list does not matter. All intermediary unit cells in the neighbor list will also be added and the order is fixed by the constructor parameters.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># site: libcasm.xtal.IntegralSiteCoordinate</span>

<span class="c1"># add site (site)</span>
<span class="n">prim_neighbor_list</span><span class="o">.</span><span class="n">add_site</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>

<span class="c1"># or equivalently (unitcell: array_like of int, shape=(3,))</span>
<span class="n">prim_neighobr_list</span><span class="o">.</span><span class="n">add_unitcell</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">unitcell</span><span class="p">())</span>
</pre></div>
</div>
<p>To get the neighbor list index for a particular site relative to the origin unit cell, use the method  <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.neighbor_index.html#libcasm.clexulator.PrimNeighborList.neighbor_index" title="libcasm.clexulator.PrimNeighborList.neighbor_index"><code class="xref py py-class docutils literal notranslate"><span class="pre">neighbor_index</span></code></a> (which will also automatically expand the list if necessary).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">site</span> <span class="o">=</span> <span class="n">xtal</span><span class="o">.</span><span class="n">IntegralSiteCoordinate</span><span class="p">(</span>
    <span class="n">sublattice</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">unitcell</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">neighbor_index</span> <span class="o">=</span> <span class="n">prim_neighbor_list</span><span class="o">.</span><span class="n">neighbor_index</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the neighbor list index for a particular site relative to a different unit cell, subtract the reference unit cell coordinates first so that the unit cell coordinates of the site are releative to the reference unit cell.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">site</span> <span class="o">=</span> <span class="n">xtal</span><span class="o">.</span><span class="n">IntegralSiteCoordinate</span><span class="p">(</span>
    <span class="n">sublattice</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">unitcell</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">reference_unitcell</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">site</span> <span class="o">-=</span> <span class="n">reference_unitcell</span>
<span class="n">neighbor_index</span> <span class="o">=</span> <span class="n">prim_neighbor_list</span><span class="o">.</span><span class="n">neighbor_index</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
</pre></div>
</div>
<p>To efficiently find DoF values on neighboring sites in a particular supercell, the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a> generates (for every unit cell in the supercell) a list of the linear site indices of the neighboring sites which can be used to read DoF values from a <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.ConfigDoFValues.html#libcasm.clexulator.ConfigDoFValues" title="libcasm.clexulator.ConfigDoFValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigDoFValues</span></code></a> instance.</p>
<p>For a given supercell, the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a> can be constructed from a <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.PrimNeighborList.html#libcasm.clexulator.PrimNeighborList" title="libcasm.clexulator.PrimNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimNeighborList</span></code></a> and the transformation matrix defining the supercell.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">libcasm.clexulator</span> <span class="kn">import</span> <span class="n">SuperNeighborList</span>

<span class="c1"># transformation_matrix_to_super: numpy.ndarray[numpy.int64[3, 3]</span>
<span class="n">transformation_matrix_to_super</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>

<span class="n">super_neighbor_list</span> <span class="o">=</span> <span class="n">SuperNeighborList</span><span class="p">(</span>
    <span class="n">transformation_matrix_to_super</span><span class="p">,</span> <span class="n">prim_neighbor_list</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-a-superneighborlist">
<h2>Using a SuperNeighborList<a class="headerlink" href="#using-a-superneighborlist" title="Link to this heading">#</a></h2>
<p>The sites in the neighborhood of a particular unit cell can be iterated over using the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.sites.html#libcasm.clexulator.SuperNeighborList.sites" title="libcasm.clexulator.SuperNeighborList.sites"><code class="xref py py-class docutils literal notranslate"><span class="pre">sites</span></code></a> method of <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a>. Conversions between integer coordinate and linear index representations can be performed using <a class="reference external" href="https://prisms-center.github.io/CASMcode_pydocs/libcasm/xtal/2.0/reference/libcasm/_autosummary/libcasm.xtal.UnitCellIndexConverter.html#libcasm.xtal.UnitCellIndexConverter" title="(in libcasm-xtal v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnitCellIndexConverter</span></code></a> and <a class="reference external" href="https://prisms-center.github.io/CASMcode_pydocs/libcasm/xtal/2.0/reference/libcasm/_autosummary/libcasm.xtal.SiteIndexConverter.html#libcasm.xtal.SiteIndexConverter" title="(in libcasm-xtal v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SiteIndexConverter</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the linear site index of sites neighboring unitcell [0, 3, 1]:</span>

<span class="n">super_neighbor_list</span> <span class="o">=</span> <span class="n">SuperNeighborList</span><span class="p">(</span>
    <span class="n">transformation_matrix_to_super</span><span class="p">,</span> <span class="n">prim_neighbor_list</span><span class="p">)</span>
<span class="n">unitcell_index_converter</span> <span class="o">=</span> <span class="n">xtal</span><span class="o">.</span><span class="n">UnitCellIndexConverter</span><span class="p">(</span>
    <span class="n">transformation_matrix_to_super</span><span class="p">)</span>
<span class="n">site_index_converter</span> <span class="o">=</span> <span class="n">xtal</span><span class="o">.</span><span class="n">SiteIndexConverter</span><span class="p">(</span>
    <span class="n">transformation_matrix_to_super</span><span class="p">,</span> <span class="n">prim_neighbor_list</span><span class="o">.</span><span class="n">total_n_sublattice</span><span class="p">())</span>

<span class="n">unitcell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">linear_unitcell_index</span> <span class="o">=</span> <span class="n">unitcell_index_converter</span><span class="o">.</span><span class="n">linear_unitcell_index</span><span class="p">(</span><span class="n">unitcell</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Neighbor sites&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">linear_site_index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
    <span class="n">super_neighbor_list</span><span class="o">.</span><span class="n">sites</span><span class="p">(</span><span class="n">linear_unitcell_index</span><span class="p">)</span>
<span class="p">):</span>
    <span class="n">integral_site_coordinate</span> <span class="o">=</span> \
        <span class="n">site_index_converter</span><span class="o">.</span><span class="n">integral_site_coordinate</span><span class="p">(</span><span class="n">linear_site_index</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;neighbor </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;linear_site_index: </span><span class="si">{</span><span class="n">linear_site_index</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;integral_site_coordinate: </span><span class="si">{</span><span class="n">integral_site_coordinate</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Neighbor</span> <span class="n">sites</span>
<span class="n">neighbor</span> <span class="mi">0</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">130</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">1</span>
<span class="n">neighbor</span> <span class="mi">1</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">1130</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">1</span>
<span class="n">neighbor</span> <span class="mi">2</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">129</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span> <span class="mi">2</span> <span class="mi">1</span>
<span class="n">neighbor</span> <span class="mi">3</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">1129</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="mi">2</span> <span class="mi">1</span>
<span class="o">...</span>
<span class="n">neighbor</span> <span class="mi">63</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">1132</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">1</span>
<span class="n">neighbor</span> <span class="mi">64</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">152</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">1</span>
<span class="n">neighbor</span> <span class="mi">65</span><span class="p">:</span> <span class="n">linear_site_index</span><span class="p">:</span> <span class="mi">1152</span> <span class="n">integral_site_coordinate</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The unit cells in the neighborhood of a particular unit cell can be similarly iterated over using the <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.unitcells.html#libcasm.clexulator.SuperNeighborList.unitcells" title="libcasm.clexulator.SuperNeighborList.unitcells"><code class="xref py py-class docutils literal notranslate"><span class="pre">unitcells</span></code></a> method of <a class="reference internal" href="../reference/libcasm/_autosummary/libcasm.clexulator.SuperNeighborList.html#libcasm.clexulator.SuperNeighborList" title="libcasm.clexulator.SuperNeighborList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperNeighborList</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Neighbor unit cells&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nbor_linear_unitcell_index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
    <span class="n">super_neighbor_list</span><span class="o">.</span><span class="n">unitcells</span><span class="p">(</span><span class="n">linear_unitcell_index</span><span class="p">)</span>
<span class="p">):</span>
    <span class="n">nbor_unitcell</span> <span class="o">=</span> <span class="n">unitcell_index_converter</span><span class="o">.</span><span class="n">unitcell</span><span class="p">(</span><span class="n">nbor_linear_unitcell_index</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;neighbor </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;nbor_linear_unitcell_index: </span><span class="si">{</span><span class="n">nbor_linear_unitcell_index</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;nbor_unitcell: </span><span class="si">{</span><span class="n">nbor_unitcell</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Neighbor</span> <span class="n">unit</span> <span class="n">cells</span>
<span class="n">neighbor</span> <span class="mi">0</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">130</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">neighbor</span> <span class="mi">1</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">129</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">neighbor</span> <span class="mi">2</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">139</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">neighbor</span> <span class="mi">3</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">120</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">neighbor</span> <span class="mi">30</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">150</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">neighbor</span> <span class="mi">31</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">132</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">neighbor</span> <span class="mi">32</span><span class="p">:</span> <span class="n">nbor_linear_unitcell_index</span><span class="p">:</span> <span class="mi">152</span> <span class="n">nbor_unitcell</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="order_parameters.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluating order parameters</p>
      </div>
    </a>
    <a class="right-next"
       href="../reference/libcasm/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">libcasm package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-neighbor-lists">Constructing neighbor lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-superneighborlist">Using a SuperNeighborList</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/usage/neighbor_lists.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, CASM Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>